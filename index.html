<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>WinCE Quiz Dashboard</title><style>:root{--xp-bg:#c0c0c0;--xp-dark:#808080;--xp-light:#f0f0f0;--xp-blue:#0a246a;--xp-accent:#0078d7;--xp-border:#404040;--xp-text:#000000;--danger:#b00020}*{box-sizing:border-box;font-family:"Tahoma","Segoe UI",sans-serif}body{margin:0;background:radial-gradient(circle at top left,#e0e0e0,#a0a0a0);color:var(--xp-text)}.app-shell{max-width:960px;margin:20px auto;border:2px solid var(--xp-border);background:var(--xp-bg);box-shadow:0 0 0 1px #fff inset,0 0 12px rgba(0,0,0,.4)}.title-bar{display:flex;align-items:center;justify-content:space-between;background:linear-gradient(to right,#0a246a,#3a6ea5);color:#fff;padding:4px 8px;font-size:12px}.title-left{display:flex;align-items:center;gap:6px}.logo-box{width:18px;height:18px;background:linear-gradient(135deg,#0ff,#f0f);border-radius:3px;border:1px solid #fff}.title-text{font-weight:bold}.title-right{display:flex;align-items:center;gap:8px;font-size:11px}.user-logo{width:20px;height:20px;border-radius:3px;border:1px solid #fff;background-size:cover;background-position:center;background-color:#444}.hamburger{display:none;width:20px;height:16px;flex-direction:column;justify-content:space-between;cursor:pointer}.hamburger span{display:block;height:3px;background:#fff;border-radius:2px}.window-body{padding:10px;background:linear-gradient(to bottom,#f4f4f4,#c0c0c0)}.top-status-bar{display:flex;justify-content:space-between;align-items:center;background:#d4d4d4;border:1px solid #fff;box-shadow:0 0 0 1px #808080 inset;padding:4px 8px;font-size:11px;margin-bottom:8px}.status-group{display:flex;align-items:center;gap:10px}.status-label{font-weight:bold}.pill{padding:2px 6px;border-radius:10px;border:1px solid #808080;background:#f8f8f8;min-width:60px;text-align:center}.pill-balance{background:linear-gradient(to bottom,#e8ffe8,#b0e0b0)}.pill-reversal{background:linear-gradient(to bottom,#ffe8e8,#e0b0b0)}.pill-logged{background:linear-gradient(to bottom,#e8f0ff,#b0c4e0)}.content-grid{display:grid;grid-template-columns:260px 1fr;gap:10px}.panel{border:1px solid #fff;box-shadow:0 0 0 1px #808080 inset;background:#dcdcdc;padding:8px;font-size:12px}.panel-title{font-weight:bold;margin-bottom:6px;padding-bottom:3px;border-bottom:1px solid #b0b0b0}.field-group{margin-bottom:6px}.field-label{display:block;font-size:11px;margin-bottom:2px}input[type="text"],input[type="password"]{width:100%;padding:3px 4px;border:1px solid #808080;background:#fff;font-size:12px}button{padding:3px 10px;font-size:12px;border:1px solid #404040;background:linear-gradient(to bottom,#f8f8f8,#c0c0c0);cursor:pointer}button:active{background:linear-gradient(to bottom,#c0c0c0,#f8f8f8)}button[disabled]{opacity:.5;cursor:default}.btn-primary{background:linear-gradient(to bottom,#fff,#d0e4ff);border-color:#0a246a}.btn-danger{background:linear-gradient(to bottom,#ffe0e0,#ffb0b0);border-color:#800000}.mini-note{font-size:10px;color:#333}.quiz-questions{margin-top:6px}.quiz-question{margin-bottom:6px;padding:4px;border-radius:3px;background:#f4f4f4;border:1px solid #b0b0b0}.quiz-question span{font-weight:bold}.quiz-input{margin-top:3px}.info-line{font-size:11px;margin-top:4px}.reward-info-box{margin-top:6px;padding:4px;border-radius:3px;background:#fffbe8;border:1px solid #c0a000;font-size:11px}.footer-bar{margin-top:8px;font-size:10px;text-align:right;color:#333}.hidden{display:none!important}.toast{position:fixed;bottom:12px;left:12px;background:var(--danger);color:#fff;padding:8px 12px;border-radius:4px;font-size:11px;box-shadow:0 2px 6px rgba(0,0,0,.4);opacity:0;pointer-events:none;transform:translateY(10px);transition:opacity .2s ease,transform .2s ease;z-index:9999}.toast.show{opacity:1;pointer-events:auto;transform:translateY(0)}@media (max-width:720px){.app-shell{margin:5px}.content-grid{grid-template-columns:1fr}.hamburger{display:flex}.left-panel-collapsed .left-panel{display:none}.toast{left:50%;transform:translate(-50%,10px)}.toast.show{transform:translate(-50%,0)}}</style></head><body><div class="app-shell" id="appShell"><div class="title-bar"><div class="title-left"><div class="logo-box"></div><div class="title-text">Quiz Rewards Console</div></div><div class="title-right"><div id="titleUser" class="mini-user">Guest</div><div id="titleUserLogo" class="user-logo"></div><div class="hamburger" id="hamburger"><span></span><span></span><span></span></div></div></div><div class="window-body"><div class="top-status-bar"><div class="status-group"><span class="status-label">Session:</span><span id="loginStatus" class="pill pill-logged">Logged out</span><button id="logoutBtn" class="btn-danger" style="display:none">Logout</button></div><div class="status-group"><span class="status-label">Balance:</span><span id="balancePill" class="pill pill-balance">0.0 pts</span><span class="status-label">Reversal:</span><span id="reversalPill" class="pill pill-reversal">0.0 %</span></div></div><div class="content-grid"><div class="panel left-panel"><div class="panel-title">Logo | LOGIN | Quiz Access</div><div id="loginPanel"><div class="field-group"><label class="field-label" for="userIdInput">UserID</label><input type="text" id="userIdInput" placeholder="demo"></div><div class="field-group"><label class="field-label" for="passIdInput">PassID</label><input type="password" id="passIdInput" placeholder="demo"></div><button id="loginBtn" class="btn-primary">Login</button><div class="mini-note">Use demo / demo to match sample row.</div></div><div id="quizIdPanel" class="hidden"><div class="field-group" style="margin-top:8px"><label class="field-label" for="quizIdInput">Quiz Access ID</label><input type="text" id="quizIdInput" placeholder="demo01"></div><button id="loadQuizBtn" class="btn-primary">Load Quiz</button><div class="mini-note">Quiz data is loaded from your CSV sheet.</div></div></div><div class="panel"><div class="panel-title">Mini Dashboard | Quiz | Reward</div><div id="quizPanel" class="hidden"><div id="quizMeta" class="info-line"></div><div class="quiz-questions" id="quizQuestions"></div><button id="submitQuizBtn" class="btn-primary" disabled>Submit Answers</button><div id="quizResult" class="info-line"></div></div><div id="rewardPanel" class="hidden"><div class="info-line"><strong>Reward:</strong> <span id="rewardNameLabel"></span> | <strong>Reward Amount:</strong> <span id="rewardAmountLabel"></span></div><button id="redeemBtn" class="btn-primary">Redeem Reward</button><div id="rewardInfoBox" class="reward-info-box hidden"></div></div></div></div><div class="footer-bar">Reversal % = (1 − (Earned / Total)) × 100 &nbsp;|&nbsp; 1/3 of 250 = 83.3 pts</div></div></div><div id="toast" class="toast"></div><script>const CSV_URL="https://docs.google.com/spreadsheets/d/e/2PACX-1vR8c9rGFe2qunf8205Gu59lTiysorK2s1hJbLtnBZ1VRh-84UM4iNSmR1_fI8S1dgKhZTDLEvhYkNxK/pub?gid=0&single=true&output=csv";let cU=null,cR=null,cB=0,cR2=0,eTQ=0,aS=document.getElementById("appShell"),h=document.getElementById("hamburger"),lP=document.getElementById("loginPanel"),qP=document.getElementById("quizIdPanel"),qP2=document.getElementById("quizPanel"),rP=document.getElementById("rewardPanel"),lB=document.getElementById("loginBtn"),loB=document.getElementById("logoutBtn"),lqB=document.getElementById("loadQuizBtn"),sqB=document.getElementById("submitQuizBtn"),rB=document.getElementById("redeemBtn"),lS=document.getElementById("loginStatus"),bP=document.getElementById("balancePill"),rP2=document.getElementById("reversalPill"),tU=document.getElementById("titleUser"),tUL=document.getElementById("titleUserLogo"),qM=document.getElementById("quizMeta"),qQ=document.getElementById("quizQuestions"),qR=document.getElementById("quizResult"),rNL=document.getElementById("rewardNameLabel"),rAL=document.getElementById("rewardAmountLabel"),rIB=document.getElementById("rewardInfoBox"),tE=document.getElementById("toast");function sT(m){tE.textContent=m,tE.classList.add("show"),setTimeout(()=>{tE.classList.remove("show")},2500)}function sLI(u,l){cU=u,lS.textContent="Logged in",lS.classList.add("pill-logged"),tU.textContent=u,l?(tUL.style.backgroundImage=`url('${l}')`,tUL.style.backgroundColor=""):(tUL.style.backgroundImage="none",tUL.style.backgroundColor="#444"),lP.classList.add("hidden"),qP.classList.remove("hidden"),loB.style.display="inline-block"}function sLO(){cU=null,cR=null,cB=0,cR2=0,eTQ=0,lS.textContent="Logged out",tU.textContent="Guest",tUL.style.backgroundImage="none",tUL.style.backgroundColor="#444",bP.textContent="0.0 pts",rP2.textContent="0.0 %",lP.classList.remove("hidden"),qP.classList.add("hidden"),qP2.classList.add("hidden"),rP.classList.add("hidden"),loB.style.display="none",qQ.innerHTML="",qR.textContent="",rIB.classList.add("hidden"),rIB.textContent=""}function uB(e,t){cB+=e;const r=t>0?(1-e/t)*100:0;cR2=r,bP.textContent=cB.toFixed(1)+" pts",rP2.textContent=r.toFixed(1)+" %"}function pCSV(t){const e=t.trim().split(/\r?\n/).map(t=>t.split(",").map(t=>t.replace(/^"|"$/g,"")));return{header:e[0],data:e.slice(1)}}async function fS(){const t=await fetch(CSV_URL),e=await t.text();return pCSV(e)}function fR(t,e,n){const r=t.header,o=t.data,s=r.indexOf("UserID"),i=r.indexOf("PassID");if(s===-1||i===-1)return null;for(const t of o)if(t[s]===e&&t[i]===n)return{header:r,row:t};return null}function fRQ(t,e){const n=t.header,r=t.data,o=n.indexOf("Quiz Access ID");if(o===-1)return null;for(const t of r)if(t[o]===e)return{header:n,row:t};return null}function gHI(t,e){for(const n of e){const e=t.indexOf(n);if(e!==-1)return e}return-1}function bQ(h,r){qQ.innerHTML="",qR.textContent="",sqB.disabled=!1;const o=gHI(h,["Q1"]),s=gHI(h,["Q2"]),i=gHI(h,["Q3"]),l=gHI(h,["A1"]),c=gHI(h,["A2"]),a=gHI(h,["A3"]),d=gHI(h,["RewardAmount","Reward Amount"]),u=gHI(h,["Reversal","Reversal Balance"]),g=gHI(h,["Balance"]),p=gHI(h,["RewardName"]),m=gHI(h,["RewardINFO"]),y=gHI(h,["UserLogo"]);cR={q1:r[o],q2:r[s],q3:r[i],a1:r[l],a2:r[c],a3:r[a],rewardAmount:parseFloat(r[d]||"0"),rewardName:r[p]||"",rewardInfo:r[m]||"",userLogo:r[y]||""},cB=isNaN(parseFloat(r[g]||"0"))?0:parseFloat(r[g]||"0"),cR2=isNaN(parseFloat(r[u]||"0"))?0:parseFloat(r[u]||"0"),bP.textContent=cB.toFixed(1)+" pts",rP2.textContent=cR2.toFixed(1)+" %",cR.userLogo&&(tUL.style.backgroundImage=`url('${cR.userLogo}')`,tUL.style.backgroundColor=""),qM.textContent=`Reward: ${cR.rewardName} | Total Reward Amount: ${cR.rewardAmount}`;const b=[{label:"Q1",text:r[o],id:"userQ1"},{label:"Q2",text:r[s],id:"userQ2"},{label:"Q3",text:r[i],id:"userQ3"}];b.forEach(t=>{const e=document.createElement("div");e.className="quiz-question",e.innerHTML=`<div><span>${t.label}:</span> ${t.text}</div><div class="quiz-input"><input type="text" id="${t.id}" placeholder="Your answer"></div>`,qQ.appendChild(e)}),rNL.textContent=cR.rewardName,rAL.textContent=cR.rewardAmount.toFixed(1)+" pts",rIB.textContent=cR.rewardInfo,rIB.classList.add("hidden")}function gQ(){if(!cR)return;const t=document.getElementById("userQ1").value.trim(),e=document.getElementById("userQ2").value.trim(),n=document.getElementById("userQ3").value.trim();let r=0;t===String(cR.a1)&&r++,e===String(cR.a2)&&r++,n===String(cR.a3)&&r++;const o=3,s=cR.rewardAmount||0,a=s/o,c=a*r;eTQ=c,uB(c,s);if(cU&&document.getElementById("quizIdInput")){const t=document.getElementById("quizIdInput").value.trim();t&&cR&&uS(cU,t,c,s)}qR.textContent=`Correct: ${r}/${o} | Earned: ${c.toFixed(1)} pts | Total Reward: ${s.toFixed(1)} pts`}async function uS(t,e,n,r){const o="YOUR_WEB_APP_URL";if(!o||o==="YOUR_WEB_APP_URL")return;try{const s=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:t,quizId:e,earned:n,total:r})}),a=await s.json();a.success?sT("Sheet updated!"):sT("Update failed: "+a.error)}catch(t){console.warn("Update error:",t),sT("Update failed")}}function cR3(){return cR&&cB>=(cR.rewardAmount||0)}function hR(){cR3()?rIB.classList.remove("hidden"):sT("Minimum points not reached to redeem this reward.")}lB.addEventListener("click",async()=>{const t=document.getElementById("userIdInput").value.trim(),e=document.getElementById("passIdInput").value.trim();if(!t||!e)return void sT("Enter UserID and PassID.");try{const n=await fS(),r=fR(n,t,e);r?(sLI(t,r.row[gHI(r.header,["UserLogo"])]),sT(`Welcome ${t}!`)):sT("UserID / PassID not found.")}catch(t){console.error(t),sT("Error loading sheet.")}}),loB.addEventListener("click",()=>{sLO(),sT("Logged out")}),lqB.addEventListener("click",async()=>{const t=document.getElementById("quizIdInput").value.trim();if(!t)return void sT("Enter Quiz Access ID.");try{const e=await fS(),n=fRQ(e,t);n?(bQ(n.header,n.row),qP2.classList.remove("hidden"),rP.classList.remove("hidden"),sT("Quiz loaded!")):sT("Quiz Access ID not found.")}catch(t){console.error(t),sT("Error loading quiz from sheet.")}}),sqB.addEventListener("click",()=>{gQ(),sT("Quiz submitted! Balance updated.")}),rB.addEventListener("click",()=>{hR()}),h.addEventListener("click",()=>{aS.classList.toggle("left-panel-collapsed")}),sLO();</script></body></html>
