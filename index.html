<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quiz Rewards Console</title>
<style>
  :root {
    --xp-bg: #c0c0c0;
    --xp-dark: #808080;
    --xp-light: #f0f0f0;
    --xp-blue: #0a246a;
    --xp-accent: #0078d7;
    --xp-border: #404040;
    --xp-text: #000000;
    --danger: #b00020;
    --success: #0a7c00;
  }
  * { box-sizing: border-box; font-family: "Tahoma", "Segoe UI", sans-serif; }
  body {
    margin: 0;
    background: radial-gradient(circle at top left, #e0e0e0, #a0a0a0);
    color: var(--xp-text);
    min-height: 100vh;
  }
  .app-shell {
    max-width: 960px;
    margin: 20px auto;
    border: 2px solid var(--xp-border);
    background: var(--xp-bg);
    box-shadow: 0 0 0 1px #ffffff inset, 0 0 12px rgba(0,0,0,0.4);
  }
  .title-bar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: linear-gradient(to right, #0a246a, #3a6ea5);
    color: #ffffff;
    padding: 4px 8px;
    font-size: 12px;
  }
  .title-left { display: flex; align-items: center; gap: 6px; }
  .logo-box {
    width: 18px; height: 18px;
    background: linear-gradient(135deg, #00ffff, #ff00ff);
    border-radius: 3px; border: 1px solid #ffffff;
  }
  .title-text { font-weight: bold; }
  .title-right { display: flex; align-items: center; gap: 8px; font-size: 11px; }
  .user-logo {
    width: 20px; height: 20px; border-radius: 3px;
    border: 1px solid #ffffff; background-size: cover;
    background-position: center; background-color: #444;
  }
  .hamburger { display: none; width: 20px; height: 16px; flex-direction: column; justify-content: space-between; cursor: pointer; }
  .hamburger span { display: block; height: 3px; background: #ffffff; border-radius: 2px; }
  .window-body { padding: 10px; background: linear-gradient(to bottom, #f4f4f4, #c0c0c0); }
  .top-status-bar {
    display: flex; justify-content: space-between; align-items: center;
    background: #d4d4d4; border: 1px solid #ffffff;
    box-shadow: 0 0 0 1px #808080 inset; padding: 4px 8px; font-size: 11px; margin-bottom: 8px;
  }
  .status-group { display: flex; align-items: center; gap: 10px; }
  .status-label { font-weight: bold; }
  .pill {
    padding: 2px 6px; border-radius: 10px; border: 1px solid #808080;
    background: #f8f8f8; min-width: 60px; text-align: center;
  }
  .pill-balance { background: linear-gradient(to bottom, #e8ffe8, #b0e0b0); }
  .pill-reversal { background: linear-gradient(to bottom, #ffe8e8, #e0b0b0); }
  .pill-logged { background: linear-gradient(to bottom, #e8f0ff, #b0c4e0); }
  .content-grid { display: grid; grid-template-columns: 260px 1fr; gap: 10px; }
  .panel {
    border: 1px solid #ffffff; box-shadow: 0 0 0 1px #808080 inset;
    background: #dcdcdc; padding: 8px; font-size: 12px;
  }
  .panel-title {
    font-weight: bold; margin-bottom: 6px; padding-bottom: 3px;
    border-bottom: 1px solid #b0b0b0;
  }
  .field-group { margin-bottom: 8px; }
  .field-label { display: block; font-size: 11px; margin-bottom: 3px; }
  input[type="text"], input[type="password"] {
    width: 100%; padding: 4px 5px; border: 1px solid #808080;
    background: #ffffff; font-size: 12px;
  }
  button {
    padding: 4px 12px; font-size: 12px;
    border: 1px solid #404040; background: linear-gradient(to bottom, #f8f8f8, #c0c0c0);
    cursor: pointer; border-radius: 3px;
  }
  button:hover { background: linear-gradient(to bottom, #ffffff, #e0e0e0); }
  button:active { background: linear-gradient(to bottom, #c0c0c0, #f8f8f8); }
  button[disabled] { opacity: 0.55; cursor: default; }
  .btn-primary {
    background: linear-gradient(to bottom, #d0e4ff, #a0c8ff);
    border-color: #0a246a;
  }
  .btn-danger {
    background: linear-gradient(to bottom, #ffe0e0, #ffb0b0);
    border-color: #800000;
  }
  .btn-success {
    background: linear-gradient(to bottom, #e0ffe0, #a0e0a0);
    border-color: #0a7c00;
  }
  .mini-note { font-size: 10px; color: #444; margin-top: 4px; }
  .quiz-questions { margin: 8px 0; }
  .quiz-question {
    margin-bottom: 8px; padding: 6px; border-radius: 3px;
    background: #f8f8f8; border: 1px solid #b0b0b0;
  }
  .quiz-question strong { color: #0a246a; }
  .quiz-input input { margin-top: 4px; }
  .info-line { font-size: 11px; margin: 6px 0; line-height: 1.4; }
  .reward-info-box {
    margin-top: 8px; padding: 6px; border-radius: 3px;
    background: #fffbe8; border: 1px solid #c0a000; font-size: 11px;
  }
  .cashout-item {
    margin: 8px 0; padding: 8px; border-radius: 3px;
    background: #f0f8ff; border: 1px solid #4a90e2;
  }
  .cashout-item strong { color: #0a246a; }
  .cashout-item button { margin-top: 6px; }
  .footer-bar {
    margin-top: 10px; font-size: 10px; text-align: right; color: #444;
  }
  .hidden { display: none !important; }
  .toast {
    position: fixed; bottom: 16px; left: 16px;
    background: var(--danger); color: white;
    padding: 10px 14px; border-radius: 4px; font-size: 12px;
    box-shadow: 0 3px 8px rgba(0,0,0,0.5);
    opacity: 0; pointer-events: none;
    transform: translateY(12px);
    transition: all 0.25s ease;
    z-index: 9999;
    max-width: 320px;
  }
  .toast.success { background: var(--success); }
  .toast.show {
    opacity: 1; transform: translateY(0); pointer-events: auto;
  }
  @media (max-width: 720px) {
    .app-shell { margin: 8px; }
    .content-grid { grid-template-columns: 1fr; }
    .hamburger { display: flex; }
    .left-panel-collapsed .left-panel { display: none; }
    .toast { left: 50%; right: auto; transform: translateX(-50%) translateY(12px); }
    .toast.show { transform: translateX(-50%) translateY(0); }
  }
</style>
</head>
<body>
<div class="app-shell" id="appShell">
  <div class="title-bar">
    <div class="title-left">
      <div class="logo-box"></div>
      <div class="title-text">Quiz Rewards Console</div>
    </div>
    <div class="title-right">
      <div id="titleUser">Guest</div>
      <div id="titleUserLogo" class="user-logo"></div>
      <div class="hamburger" id="hamburger">
        <span></span><span></span><span></span>
      </div>
    </div>
  </div>

  <div class="window-body">
    <div class="top-status-bar">
      <div class="status-group">
        <span class="status-label">Session:</span>
        <span id="loginStatus" class="pill pill-logged">Logged out</span>
        <button id="logoutBtn" class="btn-danger" style="display:none;">Logout</button>
      </div>
      <div class="status-group">
        <span class="status-label">Balance:</span>
        <span id="balancePill" class="pill pill-balance">0.0 pts</span>
        <span class="status-label">Reversal:</span>
        <span id="reversalPill" class="pill pill-reversal">0.0 %</span>
      </div>
    </div>

    <div class="content-grid">
      <div class="panel left-panel">
        <div class="panel-title">Account | Quiz Access</div>
        
        <div id="loginPanel">
          <div class="field-group">
            <label class="field-label" for="userIdInput">UserID</label>
            <input type="text" id="userIdInput" placeholder="m123" autocomplete="off" />
          </div>
          <div class="field-group">
            <label class="field-label" for="passIdInput">Password</label>
            <input type="password" id="passIdInput" placeholder="••••••" autocomplete="off" />
          </div>
          <div style="display:flex; gap:8px; margin:10px 0;">
            <button id="loginBtn" class="btn-primary">Login</button>
            <button id="signupBtn" class="btn-success">Sign Up</button>
          </div>
          <div class="mini-note">Case-sensitive • New users: click Sign Up first</div>
        </div>

        <div id="quizIdPanel" class="hidden">
          <div class="field-group">
            <label class="field-label" for="quizIdInput">Quiz Access ID</label>
            <input type="text" id="quizIdInput" placeholder="demo01" autocomplete="off" />
          </div>
          <button id="loadQuizBtn" class="btn-primary">Load Quiz</button>
          <div class="mini-note">Questions loaded from Google Sheet</div>
        </div>
      </div>

      <div class="panel">
        <div class="panel-title">Active Quiz & Reward</div>

        <div id="quizPanel" class="hidden">
          <div id="quizMeta" class="info-line"></div>
          <div class="quiz-questions" id="quizQuestions"></div>
          <button id="submitQuizBtn" class="btn-primary" disabled>Submit Answers</button>
          <div id="quizResult" class="info-line"></div>
        </div>

        <div id="rewardPanel" class="hidden" style="margin-top:12px;">
          <div style="margin-top:16px; border-top:1px solid #b0b0b0; padding-top:10px;">
            <div class="field-group">
              <label class="field-label">Bonus Code</label>
              <input type="text" id="bonusCodeInput" placeholder="e.g. WELCOME250" />
            </div>
            <button id="redeemCodeBtn" class="btn-primary">Redeem Code</button>
          </div>
        </div>

        <div id="cashoutPanel" class="hidden" style="margin-top:12px;">
          <div style="border-top:1px solid #b0b0b0; padding-top:10px;">
            <div class="panel-title">Cashout Options</div>
            <div id="cashoutOptions" class="info-line">Cashout options will appear when you accumulate enough points</div>
          </div>
        </div>
      </div>
    </div>

    <div class="footer-bar">
      Reversal % = (1 − (Earned / Total possible)) × 100 • Higher reversal means more room for improvement!
    </div>
  </div>
</div>

<div id="toast" class="toast"></div>

<script>
// CONFIG - REPLACE WITH YOUR ACTUAL APPS SCRIPT URL
const APPS_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbziffUlLgUP8jbifYKkXxHcw47VIbaYUC28JfG8L62cffMeVEZkIda5oSmup2hjibhc/exec";

// State
let currentUser = null;
let currentUserId = null;
let currentQuiz = null;
let userBalance = 0;

// DOM cache
const $ = id => document.getElementById(id);
const els = {
  toast: $("toast"),
  loginBtn: $("loginBtn"),
  signupBtn: $("signupBtn"),
  logoutBtn: $("logoutBtn"),
  loadQuizBtn: $("loadQuizBtn"),
  submitQuizBtn: $("submitQuizBtn"),
  redeemCodeBtn: $("redeemCodeBtn"),
  titleUser: $("titleUser"),
  loginStatus: $("loginStatus"),
  balancePill: $("balancePill"),
  reversalPill: $("reversalPill"),
  loginPanel: $("loginPanel"),
  quizIdPanel: $("quizIdPanel"),
  quizPanel: $("quizPanel"),
  rewardPanel: $("rewardPanel"),
  cashoutPanel: $("cashoutPanel"),
  quizMeta: $("quizMeta"),
  quizQuestions: $("quizQuestions"),
  quizResult: $("quizResult"),
  cashoutOptions: $("cashoutOptions"),
  userIdInput: $("userIdInput"),
  passIdInput: $("passIdInput"),
  quizIdInput: $("quizIdInput"),
  bonusCodeInput: $("bonusCodeInput")
};

// Toast helper
function showToast(msg, type = "error", ms = 3200) {
  els.toast.textContent = msg;
  els.toast.className = `toast ${type} show`;
  setTimeout(() => els.toast.classList.remove("show"), ms);
}

// API call function
async function apiCall(action, data = {}) {
  if (!action) {
    showToast("Client bug: no action", "error", 5000);
    return { success: false, error: "missing action" };
  }

  try {
    // Build URL-encoded string
    const params = { action, ...data };
    const bodyParts = [];
    for (const key in params) {
      bodyParts.push(encodeURIComponent(key) + '=' + encodeURIComponent(params[key]));
    }
    const bodyString = bodyParts.join('&');
    
    const response = await fetch(APPS_SCRIPT_URL, {
      method: 'POST',
      headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
      body: bodyString,
      redirect: 'follow'
    });
    
    const text = await response.text();
    
    try {
      const result = JSON.parse(text);
      return result;
    } catch (parseErr) {
      console.error('JSON parse error:', parseErr, 'Text:', text);
      showToast('Server response error', 'error', 5000);
      return { success: false, error: 'Invalid server response' };
    }
    
  } catch (err) {
    console.error(`${action} failed:`, err);
    showToast(`Connection failed: ${err.message}`, "error", 6000);
    return { success: false, error: err.message };
  }
}

// ────────────────────────────────────────────────
// AUTH
// ────────────────────────────────────────────────
async function handleLogin() {
  const uid = els.userIdInput.value.trim();
  const pwd = els.passIdInput.value.trim();
  if (!uid || !pwd) return showToast("Enter UserID and Password");

  els.loginBtn.disabled = true; 
  els.loginBtn.textContent = "Logging in…";
  
  const res = await apiCall("login", { userId: uid, password: pwd });
  
  els.loginBtn.disabled = false; 
  els.loginBtn.textContent = "Login";

  if (!res.success) return showToast(res.error || "Login failed");

  currentUser = res.user.userId;
  currentUserId = res.user.id;
  userBalance = res.user.balance;

  els.titleUser.textContent = currentUser;
  els.loginStatus.textContent = "Logged in";
  els.loginPanel.classList.add("hidden");
  els.quizIdPanel.classList.remove("hidden");
  els.logoutBtn.style.display = "inline-block";

  updateBalanceDisplay(res.user.balance, res.user.reversal);

  showToast("Logged in!", "success");
  
  // Check if we should show cashout
  checkCashoutVisibility();
}

async function handleSignup() {
  const uid = els.userIdInput.value.trim();
  const pwd = els.passIdInput.value.trim();
  if (!uid || !pwd) return showToast("Enter UserID and Password");

  els.signupBtn.disabled = true; 
  els.signupBtn.textContent = "Creating…";
  
  const res = await apiCall("signup", { userId: uid, password: pwd });
  
  els.signupBtn.disabled = false; 
  els.signupBtn.textContent = "Sign Up";

  if (!res.success) return showToast(res.error || "Signup failed");

  // Auto-login after signup
  const loginRes = await apiCall("login", { userId: uid, password: pwd });
  if (loginRes.success) {
    currentUser = loginRes.user.userId;
    currentUserId = loginRes.user.id;
    userBalance = 0;

    els.titleUser.textContent = currentUser;
    els.loginStatus.textContent = "Logged in";
    els.loginPanel.classList.add("hidden");
    els.quizIdPanel.classList.remove("hidden");
    els.logoutBtn.style.display = "inline-block";

    updateBalanceDisplay(0, 0);
    
    showToast("Account created & logged in!", "success", 4000);
    
    // Hide cashout for new users
    els.cashoutPanel.classList.add("hidden");
  }
}

function logout() {
  currentUser = currentUserId = currentQuiz = null;
  userBalance = 0;
  els.titleUser.textContent = "Guest";
  updateBalanceDisplay(0, 0);
  els.loginStatus.textContent = "Logged out";
  els.loginPanel.classList.remove("hidden");
  els.quizIdPanel.classList.add("hidden");
  els.quizPanel.classList.add("hidden");
  els.rewardPanel.classList.add("hidden");
  els.cashoutPanel.classList.add("hidden");
  els.logoutBtn.style.display = "none";
  els.quizQuestions.innerHTML = "";
  els.quizResult.innerHTML = "";
  els.userIdInput.value = "";
  els.passIdInput.value = "";
  els.quizIdInput.value = "";
  els.bonusCodeInput.value = "";
  showToast("Logged out", "success");
}

// ────────────────────────────────────────────────
// QUIZ
// ────────────────────────────────────────────────
async function loadQuiz() {
  const qid = els.quizIdInput.value.trim();
  if (!qid) return showToast("Enter Quiz ID");

  els.loadQuizBtn.disabled = true; 
  els.loadQuizBtn.textContent = "Loading…";
  
  const res = await apiCall("getQuiz", { quizId: qid });
  
  els.loadQuizBtn.disabled = false; 
  els.loadQuizBtn.textContent = "Load Quiz";

  if (!res.success) return showToast(res.error || "Quiz not found");

  currentQuiz = res.quiz;

  els.quizMeta.textContent = `Reward: ${currentQuiz.rewardName || "?"} • ${currentQuiz.rewardAmount || 0} pts`;

  els.quizQuestions.innerHTML = "";
  els.submitQuizBtn.disabled = false;
  els.quizResult.innerHTML = "";

  let i = 1;
  while (currentQuiz[`q${i}`]) {
    const txt = currentQuiz[`q${i}`];
    const div = document.createElement("div");
    div.className = "quiz-question";
    div.innerHTML = `<strong>Q${i}:</strong> ${txt}<div class="quiz-input"><input type="text" id="ans${i}" placeholder="Your answer" autocomplete="off"></div>`;
    els.quizQuestions.appendChild(div);
    i++;
  }

  els.quizPanel.classList.remove("hidden");
  els.rewardPanel.classList.remove("hidden");
  showToast("Quiz loaded!", "success");
}

async function submitQuiz() {
  if (!currentQuiz) return showToast("No quiz loaded");
  if (!currentUser) return showToast("Please login first");

  els.submitQuizBtn.disabled = true; 
  els.submitQuizBtn.textContent = "Submitting…";

  const answers = {};
  let i = 1;
  while ($(`ans${i}`)) {
    answers[`a${i}`] = $(`ans${i}`).value.trim();
    i++;
  }

  const res = await apiCall("submitQuiz", {
    userId: currentUser,
    quizId: currentQuiz.quizId || els.quizIdInput.value.trim(),
    answers: JSON.stringify(answers)
  });

  els.submitQuizBtn.textContent = "Submit Answers";

  if (!res.success) {
    els.submitQuizBtn.disabled = false;
    return showToast(res.error || "Submission failed");
  }

  els.quizResult.innerHTML = `
    <strong>Quiz Submitted!</strong><br>
    ${res.message || "Completed"}<br>
    Correct: ${res.correct || 0}/${res.totalQuestions || 0}<br>
    Earned: <b>${Number(res.earned || 0).toFixed(1)} pts</b><br>
    New reversal: <b>${Number(res.newReversal || 0).toFixed(1)}%</b><br>
    New balance: <b>${Number(res.newBalance || 0).toFixed(1)} pts</b>
  `;

  userBalance = res.newBalance;
  updateBalanceDisplay(res.newBalance, res.newReversal);
  
  // Clear quiz input and fade out UI
  els.quizIdInput.value = "";
  els.quizPanel.style.opacity = "0.7";
  els.quizPanel.style.transition = "opacity 1s";
  
  // Disable submit button
  els.submitQuizBtn.disabled = true;
  els.submitQuizBtn.textContent = "Quiz Completed ✓";
  
  showToast("Quiz submitted successfully!", "success", 4000);
  
  // Check if we should show cashout options
  checkCashoutVisibility();
  
  // Reload cashout options if panel is visible
  if (!els.cashoutPanel.classList.contains("hidden")) {
    loadCashoutOptions();
  }
}

// ────────────────────────────────────────────────
// REDEEM
// ────────────────────────────────────────────────
async function redeemBonusCode() {
  const code = els.bonusCodeInput.value.trim();
  if (!code) return showToast("Enter bonus code");
  if (!currentUser) return showToast("Please login first");

  els.redeemCodeBtn.disabled = true; 
  els.redeemCodeBtn.textContent = "Redeeming…";
  
  const res = await apiCall("redeemCode", { 
    userId: currentUser,
    code: code 
  });
  
  els.redeemCodeBtn.disabled = false; 
  els.redeemCodeBtn.textContent = "Redeem Code";

  if (!res.success) return showToast(res.error || "Invalid or already used code");

  userBalance = res.newBalance;
  updateBalanceDisplay(res.newBalance, null);
  
  showToast(`Success! +${res.amount} pts`, "success", 4000);
  els.bonusCodeInput.value = "";
  
  // Check if we should show cashout
  checkCashoutVisibility();
}

// ────────────────────────────────────────────────
// CASHOUT
// ────────────────────────────────────────────────
function checkCashoutVisibility() {
  // Only show cashout if user has at least 100 points
  if (userBalance >= 100) {
    els.cashoutPanel.classList.remove("hidden");
    loadCashoutOptions();
  } else {
    els.cashoutPanel.classList.add("hidden");
  }
}

async function loadCashoutOptions() {
  const res = await apiCall("getCashoutOptions");
  
  if (!res.success) {
    els.cashoutOptions.innerHTML = '<span style="color:#b00020;">Failed to load options</span>';
    return;
  }
  
  if (!res.cashoutOptions || res.cashoutOptions.length === 0) {
    els.cashoutOptions.innerHTML = '<em>No cashout options available at this time</em>';
    return;
  }
  
  // Filter options user can afford
  const affordableOptions = res.cashoutOptions.filter(option => 
    Number(option.rewardAmount) <= userBalance
  );
  
  if (affordableOptions.length === 0) {
    els.cashoutOptions.innerHTML = `
      <em>You need more points to cash out. Minimum required: ${Math.min(...res.cashoutOptions.map(o => o.rewardAmount))} pts</em><br>
      <span style="font-size:10px; color:#444;">Current balance: ${userBalance} pts</span>
    `;
    return;
  }
  
  // Display affordable cashout options
  els.cashoutOptions.innerHTML = '';
  affordableOptions.forEach(option => {
    const div = document.createElement('div');
    div.className = 'cashout-item';
    div.innerHTML = `
      <strong>${option.rewardName}</strong><br>
      <span style="font-size:11px;">Cost: ${option.rewardAmount} pts</span><br>
      <span style="font-size:10px; color:#444;">${option.info}</span><br>
      <button class="btn-success cashout-redeem-btn" data-reward="${option.rewardName}" data-cost="${option.rewardAmount}">
        Cashout ${option.rewardAmount} pts
      </button>
    `;
    els.cashoutOptions.appendChild(div);
  });
  
  // Add event listeners
  document.querySelectorAll('.cashout-redeem-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      handleCashout(btn.dataset.reward, btn.dataset.cost);
    });
  });
}

async function handleCashout(rewardName, cost) {
  if (!currentUser) return showToast("Please login first");
  
  const needCost = Number(cost);
  
  if (userBalance < needCost) {
    return showToast(`Need ${needCost} pts – have ${userBalance.toFixed(1)}`);
  }
  
  if (!confirm(`Cashout "${rewardName}" for ${needCost} points? This action cannot be undone.`)) return;
  
  const res = await apiCall("cashout", {
    userId: currentUser,
    rewardName: rewardName
  });
  
  if (!res.success) return showToast(res.error || "Cashout failed");
  
  userBalance = res.newBalance;
  updateBalanceDisplay(res.newBalance, null);
  
  showToast(res.message || "Cashout successful! Check your email for details.", "success", 5000);
  
  // Reload cashout options
  loadCashoutOptions();
  checkCashoutVisibility();
}

// ────────────────────────────────────────────────
// HELPERS
// ────────────────────────────────────────────────
function updateBalanceDisplay(balance, reversal) {
  if (balance !== null && balance !== undefined) {
    els.balancePill.textContent = Number(balance).toFixed(1) + " pts";
  }
  if (reversal !== null && reversal !== undefined) {
    els.reversalPill.textContent = Number(reversal).toFixed(1) + " %";
  }
}

// ────────────────────────────────────────────────
// LISTENERS
// ────────────────────────────────────────────────
els.loginBtn.addEventListener("click", handleLogin);
els.signupBtn.addEventListener("click", handleSignup);
els.logoutBtn.addEventListener("click", logout);
els.loadQuizBtn.addEventListener("click", loadQuiz);
els.submitQuizBtn.addEventListener("click", submitQuiz);
els.redeemCodeBtn.addEventListener("click", redeemBonusCode);

els.userIdInput.onkeypress = e => { if (e.key === "Enter") handleLogin(); };
els.passIdInput.onkeypress = e => { if (e.key === "Enter") handleLogin(); };
els.quizIdInput.onkeypress = e => { if (e.key === "Enter") loadQuiz(); };
els.bonusCodeInput.onkeypress = e => { if (e.key === "Enter") redeemBonusCode(); };

document.addEventListener("keypress", e => {
  if (e.key === "Enter" && e.target.id?.startsWith("ans")) submitQuiz();
});

$("hamburger").addEventListener("click", () => {
  $("appShell").classList.toggle("left-panel-collapsed");
});

// Initialize
updateBalanceDisplay(0, 0);
</script>
</body>
</html>
